# üìà EMA Adaptive Question Paper Generator

This project is a **Question Paper Generator** web application built with [Streamlit](https://streamlit.io/) and Python. It allows teachers and educators to generate question papers for different classes, subjects, and topics, using both a database of real questions and AI-generated questions.  
It now features an **EMA Adaptive Generator** that personalizes question papers for each student based on their past performance.

---

## üåü Features

### General Features (Previous Generator)

1. **Chapter Selection**

   - Chapters are class- and subject-specific.
   - Chapter list updates based on selected class and subject.

2. **Class and Subject Selection**

   - User selects class (6‚Äì10) and relevant subject.

3. **Question Types and Count**

   - User can select the number of questions for:
     - MCQs (Multiple Choice Questions)
     - Fill in the Blanks
     - True/False
     - Descriptive Questions

4. **Smart AI-Based Question Generation**

   - Objective questions are generated by AI using relevant topic content.
   - Questions are distributed equally based on content relevance.

5. **Descriptive Questions from Database**

   - Descriptive questions are stored in the database with marks and type.
   - Fetched directly if available.

6. **AI Fallback**

   - If the database lacks enough questions, AI auto-generates them to fulfill the count.

7. **Textbook Content**

   - Chapter-wise textbook content is inserted into the database.
   - Used as context for question generation.

8. **Descriptive Question Push**

   - AI-generated descriptive questions are saved to MongoDB.

9. **Customizable Distribution**

   - Distributes questions across selected topics as per user input.

10. **CSV Export**
    - All question data can be exported using:
      ```sh
      python db_csv.py
      ```

---

### EMA Adaptive Generator Features (New)

- **Student-wise Adaptive Paper Generation:**  
  Generates question papers tailored to each student‚Äôs strengths and weaknesses using Exponential Moving Average (EMA) of their previous exam scores.

- **Exam Type & Syllabus Coverage:**  
  Supports multiple exam types (Term 1, Mid Term, Term 2, End Term) with configurable syllabus coverage for each.

- **Database & AI-Generated Questions:**  
  Pulls questions from your MongoDB database. If not enough questions are available, generates new ones using an AI model (Groq LLM) based on textbook content.

- **Modern, Interactive UI:**  
  Sidebar for student, subject, and exam type selection. Main area shows progress, statistics, and generated questions in expandable, color-coded cards. Loading spinner during question generation for better UX.

- **Downloadable Papers:**  
  Download generated papers as a clean text file or as a CSV for analysis.

- **Statistics & Meta Info:**  
  Displays total questions, total marks, and number of AI-generated questions. Shows meta info: student, class, subject, exam type, generation date, and strategy.

---

## üñ•Ô∏è How It Works

### **Frontend (Streamlit UI)**

1. **Sidebar Controls:**  
   Select a student, subject, and exam type.

2. **Main Content:**  
   Shows app title and description. On clicking "Generate EMA Adaptive Paper", calculates EMA for each topic based on the student‚Äôs past exam scores (before the selected exam), and displays a spinner while generating the paper.

3. **Results Display:**  
   Shows a success message and meta info. Statistics (total questions, marks, AI questions) in a collapsible section. Questions grouped by topic, each in a styled card showing marks, difficulty, source (DB/AI), and answer. Download buttons for text and CSV formats.

---

### **Backend (Logic & Data Flow)**

1. **Database Connections:**  
   Connects to MongoDB for student data, question bank, and textbook content.

2. **EMA Calculation:**  
   For each topic in the selected exam‚Äôs syllabus, fetches the last two exam scores for that topic and subject, before the current exam date, and calculates EMA.

3. **Question Selection:**  
   For each topic, determines the number and difficulty of questions based on EMA. Tries to fetch questions from the database. If not enough, generates additional questions using the Groq LLM, with textbook content as context.

4. **Paper Assembly:**  
   Collects all questions (DB and AI), with metadata (topic, marks, difficulty, source, answer). Stores the generated paper and questions in Streamlit session state for display and download.

5. **Download Formatting:**  
   Formats the question paper for text and CSV download, grouping by topic and including all relevant metadata.

---

## üö¶ User Flow

1. **User selects student, subject, and exam type.**
2. **Clicks "Generate EMA Adaptive Paper".**
3. **App calculates EMA for each topic, determines question distribution, fetches/generates questions.**
4. **Displays questions, stats, and download options.**

---

## Technologies Used

- **Python**
- **Streamlit** (for the web UI)
- **MongoDB** (for storing questions and textbook content)
- **Groq API** (for AI question generation)
- **python-dotenv** (for environment variable management)

---

## Setup Instructions

1. **Clone the repository**

   ```sh
   git clone https://github.com/Saxena-Shivam/question-generator.git
   cd question-generator
   ```

2. **Install dependencies**

   ```sh
   pip install -r requirements.txt
   ```

   _(Or manually: `pip install streamlit pymongo groq python-dotenv`)_

3. **Set up your `.env` file**  
   Create a `.env` file (or edit the provided one) with your API keys:

   ```
   MONGO_URI=your_mongodb_uri
   GROQ_API_KEY=your_groq_api_key
   ```

4. **Configure MongoDB**  
   Make sure your MongoDB URI and database/collection names in the code match your setup.

5. **Run the app**
   ```sh
   streamlit run app.py
   ```

---

## Folder Structure

```
.
‚îú‚îÄ‚îÄ app.py                # Main Streamlit app
‚îú‚îÄ‚îÄ ema_paper.py          # EMA adaptive backend logic
‚îú‚îÄ‚îÄ student_schema.py     # Student and exam data logic
‚îú‚îÄ‚îÄ add_textbook.py       # Script to add textbook content to MongoDB
‚îú‚îÄ‚îÄ textbook.json         # Source data for textbook content
‚îú‚îÄ‚îÄ requirements.txt      # Python dependencies
‚îú‚îÄ‚îÄ .env                  # Environment variables (API keys)
‚îî‚îÄ‚îÄ ...                   # Other scripts and data files
```

---

## Usage

1. Open the app in your browser.
2. Select the class, subject, and topics.
3. Choose the number and type of questions.
4. Generate the question paper with a mix of real and AI-generated questions.

---

## License

This project is for educational and demonstration purposes.

---

**Contributions and suggestions are welcome!**
